<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>CloudWalk</title>

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="plugins/font-awesome/css/font-awesome.min.css">
  <!-- IonIcons -->
  <link rel="stylesheet" href="dist/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/adminlte.min.css">
  <!-- Google Font: Source Sans Pro -->
  <link href="dist/css/fonts.googleapis.css" rel="stylesheet">
  <!-- image gallery -->
  <link  href="plugins/nanogallery2/css/nanogallery2.min.css" rel="stylesheet" type="text/css">
    <link href="plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <!-- time picker-->
    <link rel="stylesheet" href="plugins/daterangepicker2/daterangepicker.css">
    <!-- cropper.js-->
    <link rel="stylesheet" href="plugins/cropper/cropper.css">
    <!-- loading -->
    <link rel="stylesheet" href="plugins/loading/dist/ladda-themeless.min.css">

    <link rel="stylesheet" href="plugins/iCheck/all.css">
  <link rel="stylesheet" href="dist/css/index_reid0.css" >


</head>
<!--
BODY TAG OPTIONS:
=================
Apply one or more of the following classes to to the body tag
to get the desired effect
|---------------------------------------------------------|
|LAYOUT OPTIONS | sidebar-collapse                        |
|               | sidebar-mini                            |
|               | sidebar-open                            |
|---------------------------------------------------------|
-->
<body class="hold-transition sidebar-mini sidebar-collapse">
<div class="wrapper">
  <!-- Navbar -->
    <!--
  <nav class="main-header navbar navbar-expand bg-white navbar-light border-bottom">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#"><i class="fa fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="index.html" class="nav-link">Home</a>
      </li>
    </ul>

    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#"><i
            class="fa fa-th-large"></i></a>
      </li>
    </ul>
  </nav>
    -->
    <nav class="main-header navbar navbar-expand bg-white navbar-light border-bottom">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#"><i class="fa fa-bars"></i></a>
            </li>
        </ul>
        <div class="nav_title" style="width: 500px;margin-left:  auto;margin-right:  auto;text-align: center;font-size: 1.7em;font-weight: 500;letter-spacing: 2px;color: white;">云从研究院&nbsp·&nbsp行人跨镜追踪技术体验</div>
        <!-- Right navbar links -->


    </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="index_reid1.html" class="brand-link">
      <img src="dist/img/yc/logo.png" alt="CloudWalk Logo" class="brand-image img-circle elevation-3"
           style="opacity: .8">
      <span class="brand-text font-weight-light">云从科技</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">

      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
          <li class="nav-item">
            <a href="./index_reid1.html" class="nav-link active">
              <i class="nav-icon fa fa-user"></i>
              <p>
                  行人跨镜追踪
              </p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="nav-icon fa fa-car"></i>
              <p>
                  汽车跟踪
              </p>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->

    <!-- /.content-header -->

    <!-- Main content -->
    <div class="content">
      <div class="container-control">
          <div class="select_items" >
              <div class="select_itmes_line0">

                  <div class="form-group">
                      <select class="form-control">
                          <option>数据源：云从上海</option>
                          <option>数据源：云从上海2</option>
                      </select>
                  </div>
              </div>
              <div class="select_itmes_line1">
                <input type="text" name="datetimes" value="请选择时间区间" />
              </div>
              <div class="select_itmes_line2">
                  <div class="btn-group" style="display: inline-block;">
                      <button class="btn btn-block btn-outline-secondary" data-toggle="modal" data-target="#myModal">选择监控摄像头</button>
                  </div>
                  <div class="custom-file btn-group" style="display: inline-block;">
                      <input type="file" class="custom-file-input" id="exampleInputFile">
                      <label class="custom-file-label" for="exampleInputFile">添加检索图</label>
                  </div>
              </div>
              <div id="download_image"> <a href="dist/img/yc/demo_images.zip">下载演示图片</a></div>
              <div class="select_itmes_line3">
                  <button id="select3_confirm_button" type="button" class="btn btn-block btn-primary ladda-button" data-style="expand-left" onclick="search_person()">检索结果</button>
                  <button id="select3_clear_button" type="button" class="btn btn-block btn-outline-secondary btn-sm" onclick="clear_search_person()">重置</button>
              </div>


          </div>
          <div class="selected_image">
              <div id="nanogallery0"><div id="nanogallery0_text">请上传检索图，最多五张</div></div>
          </div>
          <div style="clear: both;"></div>
      </div>
        <div class="query_result_content card card-primary card-outline" >
            <div class="card-header">
                <h5 class="card-title"><div class="btn-group" style="display: inline-block;">
                    <button class="btn btn-block btn-outline-secondary" data-toggle="modal" data-target="#attrModel">结合属性精准检索</button>
                </div></h5>
            <!--
                <div class="card-tools ">
                    <button type="button" class="btn btn-tool" data-widget="collapse">
                        <i class="fa fa-minus"></i>
                    </button>
                    <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-wrench"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                            <a href="#" class="dropdown-item">Action</a>
                            <a href="#" class="dropdown-item">Another action</a>
                            <a href="#" class="dropdown-item">Something else here</a>
                            <a class="dropdown-divider"></a>
                            <a href="#" class="dropdown-item">Separated link</a>
                        </div>
                    </div>
                    <button type="button" class="btn btn-tool" data-widget="remove">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
            -->

            </div>
            <div class="container-fluid card-body">
                <div id="nanogallery2_container">
                    <div id="nanogallery2_text">暂无查询结果</div>
                </div>
                <!--
                <div id="nanogallery2"
                     data-nanogallery2 = '{
              "colorScheme": {
                  "thumbnail": {
                    "background": "rgba(255,255,255,1)",
                    "borderColor": "rgba(217,237,247,1)"
                  }
                },
                "thumbnailBorderVertical": 2,
                "thumbnailBorderHorizontal": 2,
                "thumbnailHoverEffect2": "image_scale_1.0_1.1|toolsAppear",
                "thumbnailHeight":  200,
                "thumbnailWidth":   150,
                "thumbnailLabel": {
                  "align": "left",
                  "position": "onBottom",
                  "displayDescription": true
                },
                "galleryDisplayMode": "pagination",
                "galleryPaginationMode": "numbers",

                "thumbnailGutterWidth": 25,
                "thumbnailGutterHeight": 20,
                    "itemsBaseURL":     ""
                  }' >
                    <a href = "dist/img/yc/person/img1.jpg"   data-ngThumb = "dist/img/yc/person/img1.jpg" data-ngdesc="2018-03-11 15:13:11">96.1% 摄像头</a>
                    <a href = "dist/img/yc/person/img12.jpg"   data-ngThumb = "dist/img/yc/person/img12.jpg" >94.1%  Berlin 2 </a>
                    <a href = "dist/img/yc/person/img22.jpg"   data-ngThumb = "dist/img/yc/person/img32.jpg" >92.1%  Berlin 3 </a>
                    <a href = "dist/img/yc/person/img21.jpg"   data-ngThumb = "dist/img/yc/person/img21.jpg" > Berlin 4 </a>
                    <a href = "dist/img/yc/person/img41.jpg"   data-ngThumb = "dist/img/yc/person/img41.jpg" > Berlin 5 </a>
                    <a href = "dist/img/yc/person/img51.jpg"   data-ngThumb = "dist/img/yc/person/img51.jpg" > Berlin 6 </a>
                    <a href = "dist/img/yc/person/img61.jpg"   data-ngThumb = "dist/img/yc/person/img61.jpg" > Berlin 7 </a>
                    <a href = "dist/img/yc/person/img61.jpg"   data-ngThumb = "dist/img/yc/person/img71.jpg" > Berlin 8 </a>
                    <a href = "dist/img/yc/person/img81.jpg"   data-ngThumb = "dist/img/yc/person/img81.jpg" > Berlin 9 </a>
                    <a href = "dist/img/yc/person/img91.jpg"   data-ngThumb = "dist/img/yc/person/img91.jpg" > Berlin 10 </a>
                    <a href = "dist/img/yc/person/img16.jpg"   data-ngThumb = "dist/img/yc/person/img16.jpg" > Berlin 11 </a>
                    <a href = "dist/img/yc/person/img19.jpg"   data-ngThumb = "dist/img/yc/person/img19.jpg" > Berlin 12 </a>
                    <a href = "dist/img/yc/person/img121.jpg"   data-ngThumb = "dist/img/yc/person/img121.jpg" > Berlin 13 </a>
                    <a href = "dist/img/yc/person/img131.jpg"   data-ngThumb = "dist/img/yc/person/img131.jpg" > Berlin 14 </a>
                    <a href = "dist/img/yc/person/img141.jpg"   data-ngThumb = "dist/img/yc/person/img141.jpg" > Berlin 15 </a>
                    <a href = "dist/img/yc/person/img151.jpg"   data-ngThumb = "dist/img/yc/person/img151.jpg" > Berlin 16 </a>
                    <a href = "dist/img/yc/person/img161.jpg"   data-ngThumb = "dist/img/yc/person/img161.jpg" > Berlin 17 </a>
                    <a href = "dist/img/yc/person/img171.jpg"   data-ngThumb = "dist/img/yc/person/img171.jpg" > Berlin 18 </a>
                    <a href = "dist/img/yc/person/img181.jpg"   data-ngThumb = "dist/img/yc/person/img181.jpg" > Berlin 19 </a>
                    <a href = "dist/img/yc/person/img191.jpg"   data-ngThumb = "dist/img/yc/person/img191.jpg" > Berlin 20 </a>
                    <a href = "dist/img/yc/person/img201.jpg"   data-ngThumb = "dist/img/yc/person/img201.jpg" > Berlin 21 </a>
                    <a href = "dist/img/yc/person/img32.jpg"   data-ngThumb = "dist/img/yc/person/img32.jpg" > Berlin 22 </a>
                    <a href = "dist/img/yc/person/img45.jpg"   data-ngThumb = "dist/img/yc/person/img45.jpg" > Berlin 23 </a>
                    <a href = "dist/img/yc/person/img67.jpg"   data-ngThumb = "dist/img/yc/person/img67.jpg" > Berlin 24 </a>
                    <a href = "dist/img/yc/person/img78.jpg"   data-ngThumb = "dist/img/yc/person/img78.jpg" > Berlin 25 </a>
                    <a href = "dist/img/yc/person/img98.jpg"   data-ngThumb = "dist/img/yc/person/img98.jpg" > Berlin 26 </a>
                    <a href = "dist/img/yc/person/img93.jpg"   data-ngThumb = "dist/img/yc/person/img93.jpg" > Berlin 27 </a>
                    <a href = "dist/img/yc/person/img132.jpg"   data-ngThumb = "dist/img/yc/person/img132.jpg" > Berlin 28 </a>
                    <a href = "dist/img/yc/person/img146.jpg"   data-ngThumb = "dist/img/yc/person/img146.jpg" > Berlin 29 </a>
                    <a href = "dist/img/yc/person/img91.jpg"   data-ngThumb = "dist/img/yc/person/img91.jpg" > Berlin 30 </a>
                    <a href = "dist/img/yc/person/img16.jpg"   data-ngThumb = "dist/img/yc/person/img16.jpg" > Berlin 31 </a>
                    <a href = "dist/img/yc/person/img19.jpg"   data-ngThumb = "dist/img/yc/person/img19.jpg" > Berlin 32 </a>
                    <a href = "dist/img/yc/person/img121.jpg"   data-ngThumb = "dist/img/yc/person/img121.jpg" > Berlin 33 </a>
                    <a href = "dist/img/yc/person/img131.jpg"   data-ngThumb = "dist/img/yc/person/img131.jpg" > Berlin 34 </a>
                    <a href = "dist/img/yc/person/img141.jpg"   data-ngThumb = "dist/img/yc/person/img141.jpg" > Berlin 35 </a>
                    <a href = "dist/img/yc/person/img151.jpg"   data-ngThumb = "dist/img/yc/person/img151.jpg" > Berlin 36 </a>
                    <a href = "dist/img/yc/person/img161.jpg"   data-ngThumb = "dist/img/yc/person/img161.jpg" > Berlin 37 </a>
                    <a href = "dist/img/yc/person/img171.jpg"   data-ngThumb = "dist/img/yc/person/img171.jpg" > Berlin 38 </a>
                    <a href = "dist/img/yc/person/img181.jpg"   data-ngThumb = "dist/img/yc/person/img181.jpg" > Berlin 39 </a>
                    <a href = "dist/img/yc/person/img191.jpg"   data-ngThumb = "dist/img/yc/person/img191.jpg" > Berlin 40 </a>
                    <a href = "dist/img/yc/person/img201.jpg"   data-ngThumb = "dist/img/yc/person/img201.jpg" > Berlin 41 </a>
                    <a href = "dist/img/yc/person/img32.jpg"   data-ngThumb = "dist/img/yc/person/img32.jpg" > Berlin 42 </a>
                    <a href = "dist/img/yc/person/img45.jpg"   data-ngThumb = "dist/img/yc/person/img45.jpg" > Berlin 43 </a>
                    <a href = "dist/img/yc/person/img67.jpg"   data-ngThumb = "dist/img/yc/person/img67.jpg" > Berlin 44 </a>
                    <a href = "dist/img/yc/person/img78.jpg"   data-ngThumb = "dist/img/yc/person/img78.jpg" > Berlin 45 </a>
                    <a href = "dist/img/yc/person/img98.jpg"   data-ngThumb = "dist/img/yc/person/img98.jpg" > Berlin 46 </a>
                    <a href = "dist/img/yc/person/img93.jpg"   data-ngThumb = "dist/img/yc/person/img93.jpg" > Berlin 47 </a>
                    <a href = "dist/img/yc/person/img132.jpg"   data-ngThumb = "dist/img/yc/person/img132.jpg" > Berlin 48 </a>
                    <a href = "dist/img/yc/person/img146.jpg"   data-ngThumb = "dist/img/yc/person/img146.jpg" > Berlin 49 </a>
                </div>
                -->
                <!-- /.row -->
            </div>
        </div>

      <!-- /.container-fluid -->
    </div>

    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->

  <!-- Main Footer -->
  <footer class="main-footer">
    <!-- To the right -->
    <div class="float-right d-none d-sm-block-down">
      Anything you want
    </div>
    <!-- Default to the left -->
    <strong>CloudWalk Technology Co., Ltd.</strong>
  </footer>


</div>
<!-- ./wrapper -->

<!-- REQUIRED SCRIPTS -->

<!-- jQuery -->
<script src="plugins/jquery/jquery.min.js"></script>


<!-- Bootstrap -->
<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

<!--time picker-->
<script src="plugins/daterangepicker2/moment.min.js"></script>
<script src="plugins/daterangepicker2/daterangepicker.js"></script>

<!-- cropper.js-->
<script src="plugins/cropper/cropper.js"></script>

<script src="plugins/knob/jquery.knob.js"></script>

<!-- AdminLTE -->
<script src="dist/js/adminlte.js"></script>

<!--loading-->
<script src="plugins/loading/dist/spin.min.js"></script>
<script src="plugins/loading/dist/ladda.min.js"></script>

<script  type="text/javascript" src="plugins/iCheck/icheck.min.js"></script>

<script src="dist/js/demo.js"></script>
<script src="dist/js/pages/dashboard.js"></script>
<script  type="text/javascript" src="plugins/nanogallery2/jquery.nanogallery2.js"></script>



<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">选择摄像头</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>摄像头列表</label>
                    <select multiple="" class="form-control">
                        <option>二楼长廊</option>
                        <option>会议室门口</option>
                        <option>电梯口</option>
                        <option>茶洗室过道</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
<!-- 模态框（Modal） -->
<div class="modal fade" id="attrModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="attrLabel">选择属性（待开发）</h4>
            </div>
            <div class="modal-body">
                <div>
                    <!-- radio -->
                    <div class="row form-group">
                        <div class="col col-md-3">
                            <label class=" form-control-label">目的</label>
                        </div>
                        <div class="col col-md-9">
                            <label>
                                <input type="radio" name="r3" class="flat-red" checked>
                                重点关注
                            </label>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <label>
                                <input type="radio" name="r3" class="flat-red">
                                特意忽略
                            </label>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row form-group" id="attr_container">
                    <!--
                    <div class="col col-md-3"><label class=" form-control-label">性别</label></div>
                    <div class="col col-md-9">
                        <div class="form-check-inline form-check">
                            <label for="inline-checkbox1" class="form-check-label ">
                                <input type="checkbox" id="inline-checkbox1" name="inline-checkbox1" value="option1" class="form-check-input">男
                            </label>
                            <label for="inline-checkbox2" class="form-check-label ">
                                <input type="checkbox" id="inline-checkbox2" name="inline-checkbox2" value="option2" class="form-check-input">女
                            </label>
                        </div>
                    </div>
                    -->
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<!-- 模态框（Modal） -->
<div class="modal fade" id="image_edit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="imageLabel">截取图片</h4>
            </div>
            <div class="modal-body">
                <div id="image_edit_container" class="image_container">

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="imageCrop()">确定</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<!--
<div style="width: 500px">
    <img width="100%" id="image2" src="dist/img/photo4.jpg">
</div>

<div style="width: 300px">
    <img width="100%" id="image22" src="">
</div>
-->
</body>

<script>
    attr_option=[
        {
            option_name:"性别",
            options:[
                {
                    value:1,
                    text:"男"
                },
                {
                    value:2,
                    text:"女"
                }]
        },
        {
            option_name:"年龄",
            options:[
                {
                    value:1,
                    text:"儿童"
                },
                {
                    value:2,
                    text:"成人"
                },
                {
                    value:3,
                    text:"老人"
                }]
        },
        {
            option_name:"身体朝向",
            options:[
                {
                    value:1,
                    text:"正向"
                },
                {
                    value:2,
                    text:"背向"
                },
                {
                    value:3,
                    text:"侧向"
                }]
        },
        {
            option_name:"人种",
            options:[
                {
                    value:1,
                    text:"黄"
                },
                {
                    value:2,
                    text:"白"
                },
                {
                    value:3,
                    text:"黑"
                }]
        },
        {
            option_name:"骑车",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"戴帽子",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"戴眼镜",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"戴口罩",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"戴头巾",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"有胡子",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"双肩包",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"单肩包",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"拎包",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"长短袖",
            options:[
                {
                    value:1,
                    text:"长"
                },
                {
                    value:2,
                    text:"短"
                }]
        },
        {
            option_name:"上衣有条纹",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"上衣有格子",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"上衣有Logo",
            options:[
                {
                    value:1,
                    text:"是"
                },
                {
                    value:2,
                    text:"否"
                }]
        },
        {
            option_name:"上衣款式",
            options:[
                {
                    value:1,
                    text:"T恤"
                },
                {
                    value:2,
                    text:"衬衣"
                },
                {
                    value:3,
                    text:"牛仔"
                },
                {
                    value:4,
                    text:"卫衣"
                },
                {
                    value:5,
                    text:"夹克"
                },
                {
                    value:6,
                    text:"西服"
                }]
        },
        {
            option_name:"上身颜色",
            options:[
                {
                    value:1,
                    text:"黄"
                },
                {
                    value:2,
                    text:"蓝"
                },
                {
                    value:3,
                    text:"灰"
                },
                {
                    value:4,
                    text:"黑"
                },
                {
                    value:5,
                    text:"红"
                },
                {
                    value:6,
                    text:"橙"
                },
                {
                    value:7,
                    text:"黄"
                },
                {
                    value:8,
                    text:"粉"
                },
                {
                    value:9,
                    text:"绿"
                },
                {
                    value:10,
                    text:"紫"
                },
                {
                    value:11,
                    text:"棕"
                }]
        },
        {
            option_name:"下身颜色",
            options:[
                {
                    value:1,
                    text:"黄"
                },
                {
                    value:2,
                    text:"蓝"
                },
                {
                    value:3,
                    text:"灰"
                },
                {
                    value:4,
                    text:"黑"
                },
                {
                    value:5,
                    text:"红"
                },
                {
                    value:6,
                    text:"橙"
                },
                {
                    value:7,
                    text:"黄"
                },
                {
                    value:8,
                    text:"粉"
                },
                {
                    value:9,
                    text:"绿"
                },
                {
                    value:10,
                    text:"紫"
                },
                {
                    value:11,
                    text:"棕"
                }]
        },
        {
            option_name:"裤子款式",
            options:[
                {
                    value:1,
                    text:"长裤"
                },
                {
                    value:2,
                    text:"短裤"
                },
                {
                    value:3,
                    text:"长裙"
                },
                {
                    value:4,
                    text:"短裙"
                }]
        },
        {
            option_name:"鞋子",
            options:[
                {
                    value:1,
                    text:"鞋子"
                },
                {
                    value:2,
                    text:"靴子"
                }]
        }
    ]

    $(function() {
        $('input[name="datetimes"]').daterangepicker({
            autoUpdateInput: false,
            timePicker: true,
            "timePicker24Hour": true,
            startDate:0,// moment().startOf('hour'),
            endDate: 0,//moment().startOf('hour').add(32, 'hour'),
            locale: {
                format: 'YYYY-MM-DD hh:mm A'
            }
        });
        $('input[name="datetimes"]').on('apply.daterangepicker', function(ev, picker) {
            $(this).val(picker.startDate.format('YYYY-MM-DD hh:mm A') + ' - ' + picker.endDate.format('YYYY-MM-DD hh:mm A'));
            $(this).css("color","rgb(73,80,86)")
        });

        $('input[name="datetimes"]').on('cancel.daterangepicker', function(ev, picker) {
            $(this).val('请选择时间区间');
            $(this).css("color","lightgrey")
        });
    });
    /*
    var $image = $('#image');

    $image.cropper({
        aspectRatio: "free",
        crop: function(event) {
            console.log(event.detail.x);
            console.log(event.detail.y);
            console.log(event.detail.width);
            console.log(event.detail.height);
            console.log(event.detail.rotate);
            console.log(event.detail.scaleX);
            console.log(event.detail.scaleY);
        }
    });
    */
    // loading
    //Ladda.bind( '#select3_confirm_button' );
    //Ladda.bind( '#select3_confirm_button', { timeout: 2000 } );
    var loading = Ladda.create( document.querySelector( '#select3_confirm_button' ) );

</script>


<script>
    var image_cropper;
    NUM=5;
    var interval
    var src_array=Array();

    function drawKnob(obj) {
        /* jQueryKnob */

        $(obj).knob({
            /*change : function (value) {
             //console.log("change : " + value);
             },
             release : function (value) {
             console.log("release : " + value);
             },
             cancel : function () {
             console.log("cancel : " + this.value);
             },*/
            draw: function () {

                // "tron" case
                if (this.$.data('skin') == 'tron') {

                    var a   = this.angle(this.cv)  // Angle
                            ,
                            sa  = this.startAngle          // Previous start angle
                            ,
                            sat = this.startAngle         // Start angle
                            ,
                            ea                            // Previous end angle
                            ,
                            eat = sat + a                 // End angle
                            ,
                            r   = true

                    this.g.lineWidth = this.lineWidth

                    this.o.cursor
                    && (sat = eat - 0.3)
                    && (eat = eat + 0.3)

                    if (this.o.displayPrevious) {
                        ea = this.startAngle + this.angle(this.value)
                        this.o.cursor
                        && (sa = ea - 0.3)
                        && (ea = ea + 0.3)
                        this.g.beginPath()
                        this.g.strokeStyle = this.previousColor
                        this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sa, ea, false)
                        this.g.stroke()
                    }

                    this.g.beginPath()
                    this.g.strokeStyle = r ? this.o.fgColor : this.fgColor
                    this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sat, eat, false)
                    this.g.stroke()

                    this.g.lineWidth = 2
                    this.g.beginPath()
                    this.g.strokeStyle = this.o.fgColor
                    this.g.arc(this.xy, this.xy, this.radius - this.lineWidth + 1 + this.lineWidth * 2 / 3, 0, 2 * Math.PI, false)
                    this.g.stroke()

                    return false
                }
            }
        })
        /* END JQUERY KNOB */
    }
    /*
    function addKnob(){
        var leng=30;
        //$(".nGY2GThumbnailCustomLayer").html('<div style="display:inline;width:'+leng+'px;height:'+leng+'px;"><canvas width="40" height="40" style="width: 30px; height: '+leng+'"></canvas><input type="text" class="knob" value="30" data-width="'+leng+'" data-readonly="true" readonly="readonly" data-height="'+leng+'" data-fgcolor="#3c8dbc" style="width: 25px; height: 15px; position: absolute; vertical-align: middle; margin-top: 30px; margin-left: -69px; border: 0px; background: none; font: bold 18px Arial; text-align: center; color: rgb(0, 192, 239); padding: 0px; -webkit-appearance: none;"></div>');

        $.each($(".nGY2GThumbnailCustomLayer"),function(i,cell) {
            var value = $("#nanogallery"+NUM).nanogallery2('data').items[i].customData.score;
            value=100*value;
            $(cell).html('<div style="display:inline;width:'+leng+'px;height:'+leng+'px;"><canvas width="40" height="40" style="width: 30px; height: '+leng+'"></canvas><input type="text" class="knob" value="'+value+'" data-width="'+leng+'" data-readonly="true" readonly="readonly" data-height="'+leng+'" data-fgcolor="#3c8dbc" style="width: 25px; height: 15px; position: absolute; vertical-align: middle; margin-top: 30px; margin-left: -69px; border: 0px; background: none; font: bold 18px Arial; text-align: center; color: rgb(0, 192, 239); padding: 0px; -webkit-appearance: none;"></div>');

        });


    }*/
    //$(addKnob)
    $('input[type=file]').change(function(){

        var file=this.files[0];
        // continue ...
        console.log("文件获取到了:",file);

        if(file==undefined){
            console.log("文件为空");
            return
        }
        var reader=new FileReader();

        reader.onload=function(){
            // 通过 reader.result 来访问生成的 DataURL
            var url=reader.result;
            console.log(url);
            console.log("________________________________________________");
            create_image_croper(url);
        };
        reader.readAsDataURL(file);
        $('input[type=file]').val('');
    });


    function create_image_croper(image_url_base64,edit,image_id){

        //$image.src=url;
        var image_edit_container=$("#image_edit_container");
        image_edit_container.html('<img style="width:100%;" id="image" src="">');

        var $image = $('#image');
        $image.attr("src",image_url_base64);
        //$('#image_edit').modal(options)


        if(edit==true){
            $('#image_edit').attr("data-edit",'true');
            $('#image_edit').attr("data-image_id",image_id);
        }else{
            $('#image_edit').attr("data-edit",'false');
            $('#image_edit').attr("data-image_id",'-100');
        }
        $('#image_edit').modal();
        //setTimeout("sleep()","1000");
        interval=setInterval("sleep()","10");
    }

    function imageCrop(){
        console.log("image crop");
        var image_url=image_cropper.getCroppedCanvas().toDataURL('image/jpeg');
        console.log($('#image_edit').attr("data-edit"),$('#image_edit').attr("data-edit")=="true" )
        console.log($('#image_edit').attr("data-image_id"),$('#image_edit').attr("data-image_id")>=0)
        console.log((($('#image_edit').attr("data-edit")=="true") && ($('#image_edit').attr("data-image_id")>=0)))
        if(($('#image_edit').attr("data-edit")=="true") && ($('#image_edit').attr("data-image_id")>=0)){
            console.log("替代原图")
            src_array[$('#image_edit').attr("data-image_id")]=image_url;
        }else{
            console.log("添加新图")
            src_array.push(image_url);
        }
        image_cropper.destroy();
        $("#image_edit").modal('hide');

        add_search_image('.selected_image',src_array,"nanogallery0");
    }

    //src_array.push("dist/img/yc/person/img1.jpg")
    //src_array.push("dist/img/yc/person/img12.jpg")
    function sleep() {
        var $image = $('#image');
        if ($("#image_edit").css("display")== "none") {
            console.log("I am sleeping!")
        }
        else {
            console.log("I am wakeup!");
        $image.cropper({
            aspectRatio: "free",
            crop: function (event) {
                console.log(event.detail.x);
                console.log(event.detail.y);
                console.log(event.detail.width);
                console.log(event.detail.height);
                console.log(event.detail.rotate);
                console.log(event.detail.scaleX);
                console.log(event.detail.scaleY);

            }
        });
        image_cropper = $image.data('cropper');
        window.clearInterval(interval);
        }
    }

    function search_person() {
        loading.start()
        var dataurl='/search_person/';
        var images_array=new Array();
        $.each($("#nanogallery0").find('img'),function(i,cell){
            images_array.push($(cell).attr('src'));
        });
        //console.log(images_array)
        var data=JSON.stringify({
            source_id:1,
            start_datetime:12,
            end_datetime:22,
            cameras:[100,200],
            images:images_array//[image1,image2]
        });

        $.ajax({
            url:dataurl,
            contentType: "application/json; charset=utf-8",
            data:data,
            type:"POST",
            success:function(data){
                var json_data=JSON.parse(data)
                var src_array=new Array();
                var frame_array=new Array()
                var score_set=new Array()
                var frame_datetime_set=new Array()
                var camera_position_set=new Array()
                $.each(json_data['persons'],function(i,person){

                    var person_url='data:image/jpeg;base64,'+person["person_url"];
                    var person_id=person['person_id'];
                    var bbox_score=person["bbox_score"];
                    var person_dist=person['person_dist']
                    var frame_datetime=person["frame_datetime"]
                    var camera_position=person['camera_position']
                    console.log('frame_datetime:',frame_datetime)
                    console.log("camera_position:",camera_position)

                    var frame_id=person["frame_id"];
                    var frame_url=person['frame_url'];
                    var camera_id=person['camera_id'];
                    var video_id=person['video_id'];
                    var bbox=person['bbox'];

                    src_array.push(person_url);
                    score_set.push(person_dist);
                    frame_datetime_set.push(frame_datetime);
                    camera_position_set.push(camera_position);
                    //frame_array.push(frame_url+'?bbox='+JSON.stringify(bbox));
                    frame_array.push('/search_frame?frame_id='+frame_id+'&frame_url='+frame_url+'&bbox='+JSON.stringify(bbox));
                });

                console.log("search_person success");
                $('#nanogallery2_container').html("");
                NUM=NUM+1
                add_query_result_image("#nanogallery2_container",src_array,frame_array,score_set,frame_datetime_set,camera_position_set,"nanogallery"+NUM);
                //console.log(data);
                loading.stop();
            },
            error:function(data){
                console.log("search is wrong");
                //console.log(data)
                console.log(data)
                alert("查询出错")
                loading.stop()
            }
        });
        console.log("已发送请求")
    }
    function add_search_image(select,src_set,idname){
        //add_search_image('.selected_image',src_array,"nanogallery0");
        $(select).html('<div id="'+idname+'"></div>');
        var items=Array();
        $.each(src_set,function(i,src){
            items.push({src:src})
        });
        jQuery("#"+idname).nanogallery2( {
            <!-- ### gallery settings ### -->
            "colorScheme": {
                "thumbnail": {
                    "background": "rgba(255,255,255,1)",
                    "borderColor": "rgba(255,255,255,1)"
                }
            },
            "thumbnailBorderVertical": 1,
            "thumbnailBorderHorizontal": 1,
            "thumbnailHoverEffect2": "toolsAppear|toolsSlideUp|toolsSlideDown",
            "thumbnailHeight":  160,
            "thumbnailWidth":   120,
            "thumbnailGutterWidth": 0,
            //thumbnailDisplayTransition:"none",
            //thumbnailDisplayTransitionDuration:0,
            //thumbnailDisplayInterval:0,
            "itemsBaseURL":"",
            "thumbnailOpenImage": false,
            thumbnailToolbarImage:      { topLeft: 'cart,share' },
            icons:
            {
                thumbnailShare:'<span class="fa-stack fa-sm" ><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-edit fa-stack-1x fa-inverse" onclick="edit_search_image(this)"></i></span>',
                thumbnailCart :  '<span class="fa-stack fa-sm" ><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-remove fa-stack-1x fa-inverse" onclick="remove_search_image(this)"></i></span>'
            },
            <!-- ### gallery content ### -->
            items: items

        });
    }
    function remove_search_image(obj){
        var p=$(obj).parent().parent().parent().parent().parent();
        img=p.find(".nGY2GThumbnailImg.nGY2TnImg2");
        var idx=img.attr("data-idx")-1;
        src_array.splice(idx,1);
        add_search_image('.selected_image',src_array,"nanogallery0");
    }
    function edit_search_image(obj){
        console.log("edit_search_image runnig")
        var p=$(obj).parent().parent().parent().parent().parent();
        img=p.find(".nGY2GThumbnailImg.nGY2TnImg2");
        var idx=img.attr("data-idx")-1;
        var image_url=img.attr("src");
        console.log("idx:",idx,image_url);
        create_image_croper(image_url,true,idx);
    }
    function add_query_result_image(select,src_set,frame_set,score_set,frame_datetime_set,camera_position_set,idname){
        //add_search_image('#nanogallery2_container',src_array,"nanogallery2");
        $(select).html('<div id="'+idname+'" class="query_result_list"></div>');

        var items=Array();
        $.each(src_set,function(i,src){
            items.push({
                src:frame_set[i],
                srct:src,
                title:camera_position_set[i],
                description:frame_datetime_set[i],
                customData: { score: score_set[i]}})
        });
        jQuery("#"+idname).nanogallery2( {
            "colorScheme": {
                "thumbnail": {
                    "background": "rgba(255,255,255,1)",
                    "borderColor": "rgba(217,237,247,1)"
                }
            },
            "thumbnailBorderVertical": 2,
            "thumbnailBorderHorizontal": 2,
            "thumbnailHoverEffect2": "image_scale_1.0_1.1|toolsAppear|toolsSlideDown",
            "thumbnailHeight":  240,
            "thumbnailWidth":   140,
            "thumbnailLabel": {
                "align": "left",
                "position": "onBottom",
                "displayDescription": true
            },
            "galleryDisplayMode": "pagination",
            "galleryPaginationMode": "numbers",
            "displayDescription": true,

            "thumbnailGutterWidth": 25,
            "thumbnailGutterHeight": 20,
            "itemsBaseURL":     "",
            thumbnailToolbarImage:      { topLeft: 'cart' },
            icons:                      {
                thumbnailCart :     '<span class="fa-stack fa-sm" ><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-plus fa-stack-1x fa-inverse" onclick="select_query_image(this)"></i></span>'
            },
            "fnThumbnailInit":ImgDisplayed,
            items: items

        });
    }

    var ITEM,THUM,GO

    function ImgDisplayed($thumbnail, item, GOMidx){
        ITEM=item
        THUM=$thumbnail
        GO=GOMidx

        var value=item.customData.score
        value=parseInt(100*value);

        var leng=30;
        /*
        $($($thumbnail).find('.nGY2GThumbnailCustomLayer')).html('<div style="display:inline;width:'+leng+'px;height:'+leng+'px;"><canvas width="40" height="40" style="width: 30px; height: '+leng+'"></canvas>' +
                '<input type="text" class="knob" value="'+value+'" data-width="'+leng+'" data-readonly="true" readonly="readonly" data-height="'+leng+'" data-fgcolor="#00c0ef" ' +
                'style="width: 25px; height: 15px; position: absolute; vertical-align: middle; margin-top: 30px; margin-left: -69px; border: 0px; background: none; font: bold 18px Arial; text-align: center; color: #3c8dbc; padding: 0px; -webkit-appearance: none;"></div>');
        */
        //drawKnob($($thumbnail).find(".knob"));
    }
    function clear_search_person(){
        $(".selected_image").html('');
        src_array=new Array();
    }


    attr_html=''
    $.each(attr_option,function(i,cell){
        attr_html=attr_html+'<div class="col col-md-3"><label class=" form-control-label">'+cell.option_name+'</label></div> <div class="col col-md-9"> <div class="form-check-inline form-check"> '
        $.each(cell["options"],function(j,val_cell){
            attr_html=attr_html+'<label for="inline-checkbox1" class="form-check-label "> <input type="checkbox" name="inline-checkbox1" value="'+val_cell['value']+'" class="form-check-input">'+val_cell['text']+' </label> &nbsp;'
        });
        attr_html=attr_html+'</div> </div>'
    });

    $("#attr_container").html(attr_html)
    //点击添加检索图
    function select_query_image(obj){
        var p=$(obj).parent().parent().parent().parent().parent();
        var src=$(p).find(".nGY2GThumbnailImg.nGY2TnImg2").attr("src");
        if(src_array.length>=5){
            alert('检索图已满5个,无法再添加');
            return;
        }
        src_array.push(src);
        add_search_image('.selected_image',src_array,"nanogallery0");
    }
    //Flat red color scheme for iCheck
    $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
        checkboxClass: 'icheckbox_flat-green',
        radioClass   : 'iradio_flat-green'
    })

    //$(search_person())
</script>

</html>
